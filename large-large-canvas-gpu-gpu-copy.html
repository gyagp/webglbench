<!doctype html>
<html>
<label id="fps">fps</label>
   <body>
      <canvas width = "1370" height = "970" id = "my_Canvas"></canvas>
      <script>
	var largeCanvasSize=3500;//set the size of large large canvas
 	var vertCode =
  'attribute vec4 a_Position;\n' +
  'attribute vec2 a_TexCoord;\n' +
  'varying vec2 v_TexCoord;\n' +
  'void main() {\n' +
  '  gl_Position = a_Position;\n' +
  '  v_TexCoord = a_TexCoord;\n' +
  '}\n';
  var verticesTexCoords = new Float32Array([
    // Vertex coordinates, texture coordinate
    -0.5,  0.5,   0.0, 1.0,
    -0.5, -0.5,   0.0, 0.0,
     0.5,  0.5,   1.0, 1.0,
     0.5, -0.5,   1.0, 0.0,
  ]);
// Fragment shader program
var fragCode =

  'precision mediump float;\n' +

  'uniform sampler2D u_Sampler;\n' +
  'varying vec2 v_TexCoord;\n' +
  'void main() {\n' +
  '  gl_FragColor = texture2D(u_Sampler, v_TexCoord);\n' +
  '}\n';

	var canvas = document.getElementById('my_Canvas');
	gl = canvas.getContext('webgl2');
	 var vertShader = gl.createShader(gl.VERTEX_SHADER);

         // Attach vertex shader source code
         gl.shaderSource(vertShader, vertCode);

         // Compile the vertex shader
         gl.compileShader(vertShader);
	         var fragShader = gl.createShader(gl.FRAGMENT_SHADER);

         // Attach fragment shader source code
         gl.shaderSource(fragShader, fragCode); 
         
         // Compile the fragmentt shader
         gl.compileShader(fragShader);

         // Create a shader program object to store
         // the combined shader program
         var shaderProgram = gl.createProgram();

         // Attach a vertex shader
         gl.attachShader(shaderProgram, vertShader);

         // Attach a fragment shader
         gl.attachShader(shaderProgram, fragShader);
                  // Link both the programs
         gl.linkProgram(shaderProgram);

         // Use the combined shader program object
         gl.useProgram(shaderProgram);
	var vertexTexCoordBuffer = gl.createBuffer();
	gl.bindBuffer(gl.ARRAY_BUFFER, vertexTexCoordBuffer);
  	gl.bufferData(gl.ARRAY_BUFFER, verticesTexCoords, gl.STATIC_DRAW);
	 var a_Position = gl.getAttribLocation(shaderProgram, 'a_Position');

 	 gl.vertexAttribPointer(a_Position, 2, gl.FLOAT, false, 16, 0);
  	gl.enableVertexAttribArray(a_Position);  // Enable the assignment of the buffer object

  // Get the storage location of a_TexCoord
  	var a_TexCoord = gl.getAttribLocation(shaderProgram, 'a_TexCoord');

  // Assign the buffer object to a_TexCoord variable
  	gl.vertexAttribPointer(a_TexCoord, 2, gl.FLOAT, false, 16, 8);
  	gl.enableVertexAttribArray(a_TexCoord);  // Enable the assignment of the buffer object
	var u_Sampler = gl.getUniformLocation(shaderProgram, 'u_Sampler');
	var tex = gl.createTexture();
	gl.activeTexture(gl.TEXTURE0);
	
	
	var largeCanvas = document.createElement("canvas");
	largeCanvas.width = largeCanvasSize;
	largeCanvas.height = largeCanvasSize;
	var largeCanvasCtx = largeCanvas.getContext("2d");
	
	var fps=0;
	var draw=function(){
		gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);
		largeCanvasCtx.fillStyle ="rgb("+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+","+Math.round(Math.random()*255)+")";
		largeCanvasCtx.fillRect(0,0,largeCanvasSize,largeCanvasSize);
		gl.bindTexture(gl.TEXTURE_2D, tex);
		gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
		gl.texImage2D(gl.TEXTURE_2D, 0, gl.SRGB8, gl.RGB, gl.UNSIGNED_BYTE, largeCanvas);
		gl.uniform1i(u_Sampler, 0);
	 	gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
	}
        var tick = function() {
	 	
    		draw();   
		fps= fps+1;
    		requestAnimationFrame(tick, canvas); // Request that the browser ?calls tick
	
 	 };
	tick();
	var fpsOut = document.getElementById('fps');
	setInterval(function(){
  	fpsOut.innerHTML =fps.toFixed(1) + " fps";
	fps=0;
	},1000);
      </script>

    </body>
</html>
